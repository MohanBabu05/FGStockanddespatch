<header class="header" data-testid="dashboard-header">
  <div class="header__brand">
    <div class="header__logo" data-testid="header-logo">
      <div class="logo-icon">
        <svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect width="40" height="40" rx="10" fill="#0F172A"/>
          <path d="M10 12h20M10 20h15M10 28h10" stroke="#10B981" stroke-width="2.5" stroke-linecap="round"/>
          <circle cx="30" cy="28" r="4" fill="#10B981" opacity="0.6"/>
        </svg>
      </div>
      <div class="logo-text">
        <span class="logo-brand">Kalsofte</span>
        <span class="logo-product">Intelligence</span>
      </div>
    </div>
  </div>

  <div class="header__title">
    <h1 data-testid="header-title">FG Stock & Dispatch Optimizer</h1>
    <div class="header__meta">
      <span class="connection-status" [ngClass]="{'connected': isConnected, 'connecting': isConnecting}" data-testid="connection-status">
        <span class="status-dot"></span>
        {{ isConnected ? 'Live' : (isConnecting ? 'Connecting...' : 'Offline') }}
      </span>
      <span class="header__timestamp" data-testid="last-updated">Updated: {{ lastUpdated }}</span>
    </div>
  </div>

  <div class="header__actions">
    <button 
      class="action-btn" 
      (click)="refreshData()"
      title="Refresh Data"
      data-testid="refresh-btn"
    >
      <lucide-icon [img]="RefreshIcon" [size]="20"></lucide-icon>
    </button>
    <button class="action-btn" title="Notifications" data-testid="notifications-btn">
      <lucide-icon [img]="BellIcon" [size]="20"></lucide-icon>
      <span class="notification-badge" *ngIf="notificationCount > 0">{{ notificationCount }}</span>
    </button>
    <button class="action-btn" title="Settings" data-testid="settings-btn">
      <lucide-icon [img]="SettingsIcon" [size]="20"></lucide-icon>
    </button>
  </div>
</header>

<!-- Filter Toolbar -->
<div class="filter-toolbar" data-testid="filter-toolbar">
  <div class="filter-toolbar__left">
    <span class="filter-label">Date Range</span>
  </div>
  
  <div class="filter-toolbar__filters">
    <div class="filter-group">
      <label for="fromDate">From</label>
      <div class="date-picker-wrapper">
        <lucide-icon [img]="CalendarIcon" [size]="16"></lucide-icon>
        <input 
          type="date" 
          id="fromDate" 
          [(ngModel)]="fromDate"
          [max]="toDate"
          (change)="validateDates()"
          data-testid="from-date-picker"
        />
      </div>
    </div>

    <div class="filter-group">
      <label for="toDate">To</label>
      <div class="date-picker-wrapper">
        <lucide-icon [img]="CalendarIcon" [size]="16"></lucide-icon>
        <input 
          type="date" 
          id="toDate" 
          [(ngModel)]="toDate"
          [min]="fromDate"
          (change)="validateDates()"
          data-testid="to-date-picker"
        />
      </div>
    </div>

    <div class="filter-actions">
      <button 
        class="btn btn--secondary" 
        (click)="resetFilters()"
        data-testid="reset-filter-btn"
      >
        Reset
      </button>
      <button 
        class="btn btn--primary" 
        (click)="applyFilter()"
        [disabled]="!isDateValid"
        data-testid="apply-filter-btn"
      >
        <lucide-icon [img]="FilterIcon" [size]="16"></lucide-icon>
        Apply
      </button>
    </div>
  </div>

  <div class="validation-message" *ngIf="!isDateValid" data-testid="date-validation-error">
    <lucide-icon [img]="AlertCircleIcon" [size]="14"></lucide-icon>
    From date must be before or equal to To date
  </div>
</div>
